:target{#application-profiler}

# Application Profiler

This module provides a middleware that profiles each request with the
[`cProfile`](https://docs.python.org/3/library/profile.html#module-cProfile "(in Python v3.11)") module. This can help identify bottlenecks in your code
that may be slowing down your application.

<Outline domain="py" objectType="class" target={"werkzeug.middleware.profiler.ProfilerMiddleware"} module={"werkzeug.middleware.profiler"} fullname={"ProfilerMiddleware"} parameters={["app", "stream=<_io.TextIOWrapper name='<stdout>' mode='w' encoding='utf-8'>", "sort_by=('time'", "'calls')", "restrictions=()", "profile_dir=None", "filename_format='{method}.{path}.{elapsed:.0f}ms.{time:.0f}.prof'"]} description={"Wrap a WSGI application and profile the execution of each\nrequest. Responses are buffered so that timings are more exact."}>
  <Outline.Signature fullname="ProfilerMiddleware" id="werkzeug.middleware.profiler.ProfilerMiddleware">
    <Outline.Keyword>class<span>{" "}</span></Outline.Keyword><Outline.Prefix>werkzeug.middleware.profiler.</Outline.Prefix><Outline.Name>ProfilerMiddleware</Outline.Name><Outline.ParameterList><span>(</span><Outline.Parameter><span className="name">app</span></Outline.Parameter>, <Outline.Parameter><span className="name">stream=\<\_io.TextIOWrapper name='\<stdout>' mode='w' encoding='utf-8'></span></Outline.Parameter>, <Outline.Parameter><span className="name">sort\_by=('time'</span></Outline.Parameter>, <Outline.Parameter><span className="name">'calls')</span></Outline.Parameter>, <Outline.Parameter><span className="name">restrictions=()</span></Outline.Parameter>, <Outline.Parameter><span className="name">profile\_dir=None</span></Outline.Parameter>, <Outline.Parameter><span className="name">filename\_format='\{method}.\{path}.\{elapsed:.0f}ms.\{time:.0f}.prof'</span></Outline.Parameter><span>)</span></Outline.ParameterList>
  </Outline.Signature>

  <Outline.Content>
    Wrap a WSGI application and profile the execution of each
    request. Responses are buffered so that timings are more exact.

    If `stream` is given, [`pstats.Stats`](https://docs.python.org/3/library/profile.html#pstats.Stats "(in Python v3.11)") are written to it
    after each request. If `profile_dir` is given, [`cProfile`](https://docs.python.org/3/library/profile.html#module-cProfile "(in Python v3.11)")
    data files are saved to that directory, one file per request.

    The filename can be customized by passing `filename_format`. If
    it is a string, it will be formatted using [`str.format()`](https://docs.python.org/3/library/stdtypes.html#str.format "(in Python v3.11)") with
    the following fields available:

    - `{method}` - The request method; GET, POST, etc.
    - `{path}` - The request path or ‘root’ should one not exist.
    - `{elapsed}` - The elapsed time of the request.
    - `{time}` - The time of the request.

    If it is a callable, it will be called with the WSGI `environ`
    dict and should return a filename.

    <FieldList>
      <dl>
        <dt className="field-name">
          Parameters
        </dt>

        <dd className="field-body">
          - <Outline.ParameterTarget>app</Outline.ParameterTarget> (<em>WSGIApplication</em>) – The WSGI application to wrap.
          - <Outline.ParameterTarget>stream</Outline.ParameterTarget> (<em>t.IO</em><em>\[</em>[<em>str</em>](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<em>] </em><em>| </em><em>None</em>) – Write stats to this stream. Disable with `None`.
          - <Outline.ParameterTarget>sort\_by</Outline.ParameterTarget> (<em>t.Iterable</em><em>\[</em>[<em>str</em>](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<em>]</em>) – A tuple of columns to sort stats by. See
            [`pstats.Stats.sort_stats()`](https://docs.python.org/3/library/profile.html#pstats.Stats.sort_stats "(in Python v3.11)").
          - <Outline.ParameterTarget>restrictions</Outline.ParameterTarget> (<em>t.Iterable</em><em>\[</em>[<em>str</em>](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<em> | </em>[<em>int</em>](https://docs.python.org/3/library/functions.html#int "(in Python v3.11)")<em> | </em>[<em>float</em>](https://docs.python.org/3/library/functions.html#float "(in Python v3.11)")<em>]</em>) – A tuple of restrictions to filter stats by. See
            [`pstats.Stats.print_stats()`](https://docs.python.org/3/library/profile.html#pstats.Stats.print_stats "(in Python v3.11)").
          - <Outline.ParameterTarget>profile\_dir</Outline.ParameterTarget> ([<em>str</em>](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")<em> | </em><em>None</em>) – Save profile data files to this directory.
          - <Outline.ParameterTarget>filename\_format</Outline.ParameterTarget> ([<em>str</em>](https://docs.python.org/3/library/stdtypes.html#str "(in Python v3.11)")) – Format string for profile data file names,
            or a callable returning a name. See explanation above.
        </dd>
      </dl>
    </FieldList>

    ```python
    from werkzeug.middleware.profiler import ProfilerMiddleware
    app = ProfilerMiddleware(app)
    ```

    <Container type="info" title="Version changed">
      <span>Changed in version 0.15: </span>Stats are written even if `profile_dir` is given, and can be
      disable by passing `stream=None`.
    </Container>

    <Container type="info" title="Version added">
      <span>New in version 0.15: </span>Added `filename_format`.
    </Container>

    <Container type="info" title="Version added">
      <span>New in version 0.9: </span>Added `restrictions` and `profile_dir`.
    </Container>
  </Outline.Content>
</Outline>

<FieldList>
  <dl>
    <dt className="field-name">
      copyright
    </dt>

    <dd className="field-body">
      2007 Pallets
    </dd>

    <dt className="field-name">
      license
    </dt>

    <dd className="field-body">
      BSD-3-Clause
    </dd>
  </dl>
</FieldList>
